{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": { "uid": "-- Grafana --" },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "limit": 100,
        "name": "Annotations & Alerts",
        "showIn": 0,
        "type": "dashboard"
      }
    ]
  },
  "description": "Proxmox Virtual Environment Dashboard (Homelab)",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "panels": [
    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "custom": { "align": "auto", "cellOptions": { "type": "auto" }, "footer": { "reducers": [] }, "inspect": false },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "Status" },
            "properties": [
              { "id": "custom.cellOptions", "value": { "type": "color-text" } },
              { "id": "mappings", "value": [{ "type": "value", "options": { "0": { "text": "Down", "color": "red" }, "1": { "text": "Up", "color": "green" } } }] },
              { "id": "thresholds", "value": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "green", "value": 1 }] } }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "CPU (%)" },
            "properties": [
              { "id": "unit", "value": "percentunit" },
              { "id": "decimals", "value": 0 },
              { "id": "custom.cellOptions", "value": { "type": "color-text" } },
              { "id": "thresholds", "value": { "mode": "absolute", "steps": [{ "color": "rgba(50, 172, 45, 0.97)", "value": null }, { "color": "rgba(237, 129, 40, 0.89)", "value": 0.7 }, { "color": "rgba(245, 54, 54, 0.9)", "value": 0.9 }] } }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Mem (%)" },
            "properties": [
              { "id": "unit", "value": "percentunit" },
              { "id": "decimals", "value": 0 },
              { "id": "custom.cellOptions", "value": { "type": "color-text" } },
              { "id": "thresholds", "value": { "mode": "absolute", "steps": [{ "color": "rgba(50, 172, 45, 0.97)", "value": null }, { "color": "rgba(237, 129, 40, 0.89)", "value": 0.7 }, { "color": "rgba(245, 54, 54, 0.9)", "value": 0.9 }] } }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Disk (%)" },
            "properties": [
              { "id": "unit", "value": "percentunit" },
              { "id": "decimals", "value": 0 },
              { "id": "custom.cellOptions", "value": { "type": "color-text" } },
              { "id": "thresholds", "value": { "mode": "absolute", "steps": [{ "color": "rgba(50, 172, 45, 0.97)", "value": null }, { "color": "rgba(237, 129, 40, 0.89)", "value": 0.7 }, { "color": "rgba(245, 54, 54, 0.9)", "value": 0.9 }] } }
            ]
          }
        ]
      },
      "gridPos": { "h": 20, "w": 24, "x": 0, "y": 0 },
      "id": 17,
      "options": { "cellHeight": "sm", "showHeader": true },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum by (id, name, type) (pve_guest_info{instance=\"$instance\",template!=\"1\"})", "format": "table", "instant": true, "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum by (id) (pve_up{instance=\"$instance\"} and on (id, instance) pve_guest_info)", "format": "table", "instant": true, "refId": "B" },
        { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum by (id) (pve_cpu_usage_ratio{instance=\"$instance\"} / pve_cpu_usage_limit{instance=\"$instance\"} and on (id, instance) pve_guest_info)", "format": "table", "instant": true, "refId": "H" },
        { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum by (id) (pve_memory_usage_bytes{instance=\"$instance\"} / pve_memory_size_bytes and on (id, instance) pve_guest_info)", "format": "table", "instant": true, "refId": "E" },
        { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum by (id) (pve_disk_usage_bytes{instance=\"$instance\"} / pve_disk_size_bytes and on (id, instance) pve_guest_info)", "format": "table", "instant": true, "refId": "G" }
      ],
      "title": "Services Summary",
      "transformations": [
        { "id": "merge", "options": { "reducers": [] } },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "type": true,
              "Value #A": true
            },
            "indexByName": {
              "id": 0,
              "name": 1,
              "Value #B": 2,
              "Value #H": 3,
              "Value #E": 4,
              "Value #G": 5
            },
            "renameByName": {
              "id": "ID",
              "name": "Name",
              "Value #B": "Status",
              "Value #H": "CPU (%)",
              "Value #E": "Mem (%)",
              "Value #G": "Disk (%)"
            }
          }
        }
      ],
      "type": "table"
    },

    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "decimals": 1, "max": 1, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": 0 }, { "color": "orange", "value": 0.75 }, { "color": "red", "value": 0.9 }] }, "unit": "percentunit" },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 4, "x": 0, "y": 20 },
      "id": 11,
      "options": { "minVizHeight": 75, "minVizWidth": 75, "orientation": "auto", "reduceOptions": { "calcs": ["last"], "fields": "", "values": false }, "showThresholdLabels": false, "showThresholdMarkers": true, "sizing": "auto" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "label_replace(pve_disk_usage_bytes{instance=\"$instance\", id=~\"storage/.+\"} / pve_disk_size_bytes{instance=\"$instance\", id=~\"storage/.+\"}, \"storage\", \"$1\", \"id\", \"^storage/[^/]+/(.+)$\")", "format": "time_series", "instant": true, "legendFormat": "{{storage}}", "refId": "A" }],
      "title": "Storage Usage",
      "type": "gauge"
    },

    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisPlacement": "auto", "fillOpacity": 80, "gradientMode": "none", "hideFrom": { "legend": false, "tooltip": false, "viz": false }, "lineWidth": 1, "scaleDistribution": { "type": "linear" }, "thresholdsStyle": { "mode": "off" } },
          "mappings": [],
          "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": 0 }] },
          "unit": "decbytes"
        },
        "overrides": [
          { "matcher": { "id": "byName", "options": "Field" }, "properties": [{ "id": "custom.axisPlacement", "value": "hidden" }] },
          { "matcher": { "id": "byName", "options": "Used" }, "properties": [{ "id": "color", "value": { "fixedColor": "semi-dark-blue", "mode": "fixed" } }] },
          { "matcher": { "id": "byName", "options": "Free" }, "properties": [{ "id": "color", "value": { "fixedColor": "light-blue", "mode": "fixed" } }, { "id": "custom.fillOpacity", "value": 30 }] }
        ]
      },
      "gridPos": { "h": 8, "w": 5, "x": 4, "y": 20 },
      "id": 15,
      "options": { "barRadius": 0, "barWidth": 0.97, "fullHighlight": false, "groupWidth": 1, "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": true }, "orientation": "auto", "showValue": "auto", "stacking": "normal", "tooltip": { "hideZeros": false, "mode": "single", "sort": "none" }, "xTickLabelRotation": 0, "xTickLabelSpacing": 0 },
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "label_replace(pve_disk_usage_bytes{instance=\"$instance\", id=~\"storage/.+\"}, \"storage\", \"$1\", \"id\", \"^storage/[^/]+/(.+)$\")", "format": "table", "instant": true, "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "label_replace(pve_disk_size_bytes{instance=\"$instance\", id=~\"storage/.+\"} - pve_disk_usage_bytes{instance=\"$instance\", id=~\"storage/.+\"}, \"storage\", \"$1\", \"id\", \"^storage/[^/]+/(.+)$\")", "format": "table", "instant": true, "refId": "B" }
      ],
      "title": "Space Allocation",
      "transformations": [
        { "id": "merge", "options": {} },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "id": true,
              "instance": true
            },
            "renameByName": {
              "storage": "Storage",
              "Value #A": "Used",
              "Value #B": "Free"
            }
          }
        }
      ],
      "type": "barchart"
    },

    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "decimals": 2, "max": 1, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": 0 }, { "color": "orange", "value": 0.7 }, { "color": "red", "value": 0.9 }] }, "unit": "percentunit" },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 5, "x": 9, "y": 20 },
      "id": 7,
      "options": { "minVizHeight": 75, "minVizWidth": 75, "orientation": "auto", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "showThresholdLabels": false, "showThresholdMarkers": true, "sizing": "auto" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "pve_cpu_usage_ratio{instance=\"$instance\", id=~\"node/.+\"}/pve_cpu_usage_limit{instance=\"$instance\", id=~\"node/.+\"}", "format": "time_series", "refId": "A" }],
      "title": "Host CPU",
      "type": "gauge"
    },

    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "decimals": 2, "max": 1, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": 0 }, { "color": "orange", "value": 0.6 }, { "color": "red", "value": 0.8 }] }, "unit": "percentunit" },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 5, "x": 14, "y": 20 },
      "id": 8,
      "options": { "minVizHeight": 75, "minVizWidth": 75, "orientation": "auto", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "showThresholdLabels": false, "showThresholdMarkers": true, "sizing": "auto" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "pve_memory_usage_bytes{instance=\"$instance\", id=~\"node/.+\"}/pve_memory_size_bytes{instance=\"$instance\", id=~\"node/.+\"}", "format": "time_series", "refId": "A" }],
      "title": "Host Memory",
      "type": "gauge"
    },

    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "thresholds" }, "decimals": 2, "max": 1, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": 0 }, { "color": "orange", "value": 0.7 }, { "color": "red", "value": 0.9 }] }, "unit": "percentunit" },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 5, "x": 19, "y": 20 },
      "id": 18,
      "options": { "minVizHeight": 75, "minVizWidth": 75, "orientation": "auto", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "showThresholdLabels": false, "showThresholdMarkers": true, "sizing": "auto" },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "pve_disk_usage_bytes{instance=\"$instance\", id=~\"node/.+\"}/pve_disk_size_bytes{instance=\"$instance\", id=~\"node/.+\"}", "format": "time_series", "refId": "A" }],
      "title": "Host Disk",
      "type": "gauge"
    },

    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "palette-classic" }, "custom": { "axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": { "legend": false, "tooltip": false, "viz": false }, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 2, "pointSize": 5, "scaleDistribution": { "type": "linear" }, "showPoints": "never", "spanNulls": false, "stacking": { "group": "A", "mode": "none" }, "thresholdsStyle": { "mode": "area" } }, "decimals": 2, "mappings": [], "thresholds": { "mode": "absolute", "steps": [{ "color": "transparent", "value": 0 }, { "color": "red", "value": 1 }] }, "unit": "percentunit" },
        "overrides": []
      },
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 28 },
      "id": 2,
      "options": { "legend": { "calcs": ["mean", "lastNotNull", "max"], "displayMode": "table", "placement": "right", "showLegend": true }, "tooltip": { "hideZeros": false, "mode": "multi", "sort": "asc" } },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "(pve_cpu_usage_ratio{instance=\"$instance\"} / pve_cpu_usage_limit{instance=\"$instance\"}) * on(id, instance) group_left(name) pve_guest_info{instance=\"$instance\"}", "format": "time_series", "intervalFactor": 4, "legendFormat": "{{name}}", "refId": "A" }],
      "title": "Guests CPU usage",
      "type": "timeseries"
    },

    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "palette-classic" }, "custom": { "axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": { "legend": false, "tooltip": false, "viz": false }, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 2, "pointSize": 5, "scaleDistribution": { "type": "linear" }, "showPoints": "never", "spanNulls": false, "stacking": { "group": "A", "mode": "none" }, "thresholdsStyle": { "mode": "area" } }, "decimals": 1, "mappings": [], "max": 1.2, "thresholds": { "mode": "absolute", "steps": [{ "color": "transparent", "value": 0 }, { "color": "red", "value": 0.9 }] }, "unit": "percentunit" },
        "overrides": []
      },
      "gridPos": { "h": 10, "w": 12, "x": 0, "y": 38 },
      "id": 5,
      "options": { "legend": { "calcs": ["mean", "lastNotNull", "max"], "displayMode": "table", "placement": "right", "showLegend": true }, "tooltip": { "hideZeros": false, "mode": "multi", "sort": "desc" } },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "(pve_memory_usage_bytes{instance=\"$instance\"} / pve_memory_size_bytes{instance=\"$instance\"}) * on(id, instance) group_left(name) pve_guest_info{instance=\"$instance\"}", "format": "time_series", "intervalFactor": 4, "legendFormat": "{{name}}", "refId": "A" }],
      "title": "Guests Memory usage",
      "type": "timeseries"
    },

    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "fieldConfig": {
        "defaults": { "color": { "mode": "palette-classic" }, "custom": { "axisBorderShow": false, "axisCenteredZero": false, "axisColorMode": "text", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 0, "gradientMode": "none", "hideFrom": { "legend": false, "tooltip": false, "viz": false }, "insertNulls": false, "lineInterpolation": "linear", "lineWidth": 2, "pointSize": 5, "scaleDistribution": { "type": "linear" }, "showPoints": "never", "spanNulls": false, "stacking": { "group": "A", "mode": "none" }, "thresholdsStyle": { "mode": "area" } }, "decimals": 1, "mappings": [], "max": 1.2, "thresholds": { "mode": "absolute", "steps": [{ "color": "transparent", "value": 0 }, { "color": "orange", "value": 0.75 }, { "color": "red", "value": 0.9 }] }, "unit": "percentunit" },
        "overrides": []
      },
      "gridPos": { "h": 10, "w": 12, "x": 12, "y": 38 },
      "id": 9,
      "options": { "legend": { "calcs": ["lastNotNull"], "displayMode": "table", "placement": "right", "showLegend": true }, "tooltip": { "hideZeros": false, "mode": "single", "sort": "none" } },
      "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "(pve_disk_usage_bytes{instance=\"$instance\"} / pve_disk_size_bytes{instance=\"$instance\"}) * on(id, instance) group_left(name) pve_guest_info{instance=\"$instance\"}", "format": "time_series", "legendFormat": "{{name}}", "refId": "A" }],
      "title": "Guests Disk usage",
      "type": "timeseries"
    },

    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 48 },
      "id": 13,
      "targets": [
        { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "rate(pve_network_receive_bytes{instance=\"$instance\"}[5m]) * on(id, instance) group_left(name) pve_guest_info{instance=\"$instance\"}", "format": "time_series", "intervalFactor": 3, "legendFormat": "{{name}} recv", "refId": "A" },
        { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "rate(pve_network_transmit_bytes{instance=\"$instance\"}[5m]) * on(id, instance) group_left(name) pve_guest_info{instance=\"$instance\"}", "format": "time_series", "intervalFactor": 3, "legendFormat": "{{name}} send", "refId": "B" }
      ],
      "timeFrom": "3h",
      "title": "Network IO/s",
      "type": "timeseries"
    },

    {
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 58 },
      "id": 12,
      "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "(rate(pve_disk_write_bytes{instance=\"$instance\"}[5m]) + rate(pve_disk_read_bytes{instance=\"$instance\"}[5m])) * on(id, instance) group_left(name) pve_guest_info{instance=\"$instance\"}", "format": "time_series", "intervalFactor": 2, "legendFormat": "{{name}}", "refId": "A" }],
      "timeFrom": "3h",
      "title": "Disk IO/s",
      "type": "timeseries"
    }
  ],
  "preload": false,
  "refresh": "10s",
  "schemaVersion": 42,
  "tags": ["Proxmox", "Prometheus", "Homelab"],
  "templating": {
    "list": [
      {
        "datasource": { "type": "prometheus", "uid": "prometheus" },
        "definition": "label_values(pve_node_info, instance)",
        "includeAll": false,
        "name": "instance",
        "query": "label_values(pve_node_info, instance)",
        "refresh": 2,
        "sort": 1,
        "type": "query"
      }
    ]
  },
  "time": { "from": "now-6h", "to": "now" },
  "timepicker": {},
  "timezone": "",
  "title": "Proxmox Homelab",
  "uid": "proxmox-homelab"
}
